<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="SPL File LivePacketLiveSourceFull.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>SPL File LivePacketLiveSourceFull.spl</title>
</head>
<body id="spldoc_compilationunit">


<h1 class="title topictitle1">SPL File <tt class="ph tt">LivePacketLiveSourceFull.spl</tt></h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Toolkits</a> &gt; <a class="xref" href="tk$SamplePacketLiveSource.html">SamplePacketLiveSource 2.0.0</a> &gt; <a class="xref" href="ns$sample.html">sample</a> &gt; LivePacketLiveSourceFull.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
  <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Operators</dt>

      <dd class="dd">
<ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="spl$sample$LivePacketLiveSourceFull.html#spldoc_compilationunit__composite_operator__LivePacketLiveSourceFull">LivePacketLiveSourceFull</a></strong>
</li>

</ul>

      </dd>

    
  </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composites</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__composite_operator__LivePacketLiveSourceFull"><h2 class="title sectiontitle splpart">public composite LivePacketLiveSourceFull</h2>
  
</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">networkInterface</strong>
</li>

<li class="sli"><strong class="ph b">metricsInterval</strong>
</li>

<li class="sli"><strong class="ph b">timeoutInterval</strong>
</li>

</ul>

</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">Composite Operator Graph</h2>
  
</div>

<div class="section splgraph">
  <embed class="image" src="../../image/tk$SamplePacketLiveSource/op$sample$LivePacketLiveSourceFull.svg" width="232" height="152"/>
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>


<div class="section">
   <pre class="pre codeblock">

 composite LivePacketLiveSourceFull {
 
     param
     expression&lt;rstring&gt; $networkInterface: getSubmissionTimeValue("networkInterface", "eth0");
     expression&lt;float64&gt; $metricsInterval: (float64)getSubmissionTimeValue("metricsInterval", "1.0" );
     expression&lt;float64&gt; $timeoutInterval: (float64)getSubmissionTimeValue("timeoutInterval", "10.0" );
 
 
     type
 
     PacketType =
         uint64 packetsReceived,             // total number of packet received, as of last metrics interval
         uint64 packetsDropped,              // total number of packet dropped, as of last metrics interval
         uint64 packetsProcessed,            // total number of packets processed by operator, so far
         uint64 bytesProcessed,             // total number of bytes of packet data processed by operator, so far
         float64 metricsIntervalElapsed,     // elapsed time since last metrics interval, in seconds
         uint64 metricsIntervalPacketsReceived,  // number of packets received since last metrics interval
         uint64 metricsIntervalPacketsDropped,   // number of packets dropped since last metrics interval
         uint64 metricsIntervalPacketsProcessed, // number of packets processed since last metrics interval
         uint64 metricsIntervalBytesProcessed,  // number of bytes processed since last metrics interval
         boolean metricsUpdated,             // true if metrics have been updated since previous output tuple
         uint32 CAPTURE_SECONDS,             // time that packet was captured, in seconds since Unix epoch
         uint32 CAPTURE_MICROSECONDS,        // time since CAPTURE_SECONDS, in microseconds
         list&lt;uint8&gt;[6] ETHER_SRC_ADDRESS,   // ethernet source address, or empty list if 'raw IP' PCAP recording
         list&lt;uint8&gt;[6] ETHER_DST_ADDRESS,   // ethernet destination address, or empty list if 'raw IP' PCAP recording
         rstring ETHER_SRC_ADDRESS_AS_STRING,// string representation of ethernet source address
         rstring ETHER_DST_ADDRESS_AS_STRING,// string representation of ethernet destination address
         uint16 ETHER_PROTOCOL,              // ethernet protocol: 0x0800==2048 for IPv4, 0x86DD==34525 for IPv6
         rstring VLAN_TAGS,                  // string representation of ethernet VLAN tags, if any
         uint8 IP_VERSION,                   // IP version: 4 for IPv4, 6 for IPv6
         uint8 IP_PROTOCOL,                  // IP protocol: 0x01==1 for ICMP, 0x6==6 for TCP, 0x11==17 for UDP
         uint32 IPV4_SRC_ADDRESS,            // IPv4 source address, or zero if not IPv4 packet
         uint32 IPV4_DST_ADDRESS,            // IPv4 destination address, or zero if not IPv4 packet
         rstring IPV4_SRC_ADDRESS_AS_STRING, // string representation of IPv4 source address
         rstring IPV4_DST_ADDRESS_AS_STRING, // string representation of IPv4 destination address
         list&lt;uint8&gt;[16] IPV6_SRC_ADDRESS,   // IPv6 source address, or zero if not IPv6 packet
         list&lt;uint8&gt;[16] IPV6_DST_ADDRESS,   // IPv6 destination address, or zero if not IPv6 packet
         rstring IPV6_SRC_ADDRESS_AS_STRING, // string representation of IPv6 source address
         rstring IPV6_DST_ADDRESS_AS_STRING, // string representation of IPv6 destination address
         uint16 IP_SRC_PORT,                 // IP source port, or zero if not UDP or TCP packet
         uint16 IP_DST_PORT,                 // IP destination port, or zero if not UDP or TCP packet
         boolean UDP_PORT_53,                // UDP source or destination port is '53' if true, else false
         uint16 UDP_SRC_PORT,                // UDP source port, or zero if not UDP packet
         uint16 UDP_DST_PORT,                // UDP destination port, or zero if not UDP packet
         boolean TCP_PORT_80,                // TCP source or destination port is '80' if true, else false
         uint16 TCP_SRC_PORT,                // TCP source port, or zero if not TCP packet
         uint16 TCP_DST_PORT,                // TCP destination port, or zero if not TCP packet
         uint32 TCP_SEQUENCE,                // TCP sequence number, or zero if not TCP packet
         uint32 TCP_ACKNOWLEDGEMENT,         // TCP acknowledgement number, or zero if not TCP packet
         boolean TCP_FLAGS_URGENT,           // TCP urgent flag, or false if not TCP packet
         boolean TCP_FLAGS_ACK,              // TCP acknowledgement flag, or false if not TCP packet
         boolean TCP_FLAGS_PUSH,             // TCP push flag, or false if not TCP packet
         boolean TCP_FLAGS_RESET,            // TCP reset flag, or false if not TCP packet
         boolean TCP_FLAGS_SYN,              // TCP synchronize flag, or false if not TCP packet
         boolean TCP_FLAGS_FIN,              // TCP final flag, or false if not TCP packet
         uint16 TCP_WINDOW,                  // TCP window size, or zero if not TCP packet
         rstring JMIRROR_SRC_ADDRESS_AS_STRING,  // 'jmirror' source address, or zero if not 'jmirror' packet
         rstring JMIRROR_DST_ADDRESS_AS_STRING,  // 'jmirror' destination address, or zero if 'jmirror' packet
         uint16 JMIRROR_SRC_PORT,            // 'jmirror' source port, or zero if not 'jmirror' packet
         uint16 JMIRROR_DST_PORT,            // 'jmirror' destination port, or zero if 'jmirror' packet
         uint32 JMIRROR_INTERCEPT_ID,        // 'jmirror' intercept ID, or zero if not 'jmirror' packet
         uint32 JMIRROR_SESSION_ID,          // 'jmirror' session ID, or zero if not 'jmirror' packet
         rstring ERSPAN_SRC_ADDRESS_AS_STRING,  // GRE ERSPAN source address, or zero if not ERSPAN packet
         rstring ERSPAN_DST_ADDRESS_AS_STRING,  // GRE ERSPAN destination address, or zero if ERSPAN packet
         uint32 PACKET_LENGTH,               // original length of packet (not necessarily all captured)
         uint32 PAYLOAD_LENGTH,              // length of packet payload, following all network headers
         blob PACKET_DATA,                   // contents of packet captured, including network headers (not necessarily complete)
         blob PAYLOAD_DATA;                  // contents of packet payload, following all network headers
 
     graph
 
     stream&lt;PacketType&gt; PacketStream as Out = PacketLiveSource() {
         logic state: { map&lt;uint8,rstring&gt; ipProtocols = { 1: "icmp", 6: "tcp", 17: "udp" }; }
         param
             networkInterface: $networkInterface;
             metricsInterval: $metricsInterval;
         output Out:
             packetsReceived = packetsReceived(),
             packetsDropped = packetsDropped(),
             packetsProcessed = packetsProcessed(),
             bytesProcessed = bytesProcessed(),
             metricsIntervalElapsed = metricsIntervalElapsed(),
             metricsIntervalPacketsReceived = metricsIntervalPacketsReceived(),
             metricsIntervalPacketsDropped = metricsIntervalPacketsDropped(),
             metricsIntervalPacketsProcessed = metricsIntervalPacketsProcessed(),
             metricsIntervalBytesProcessed = metricsIntervalBytesProcessed(),
             metricsUpdated = metricsUpdated(),
             CAPTURE_SECONDS = CAPTURE_SECONDS(),
             CAPTURE_MICROSECONDS = CAPTURE_MICROSECONDS(),
             ETHER_SRC_ADDRESS = ETHER_SRC_ADDRESS(),
             ETHER_DST_ADDRESS = ETHER_DST_ADDRESS(),
             ETHER_SRC_ADDRESS_AS_STRING = convertMACAddressNumericToString(ETHER_SRC_ADDRESS()),
             ETHER_DST_ADDRESS_AS_STRING = convertMACAddressNumericToString(ETHER_DST_ADDRESS()),
             ETHER_PROTOCOL = ETHER_PROTOCOL(),
             VLAN_TAGS = (rstring)VLAN_TAGS(),
             IP_VERSION = IP_VERSION(),
             IP_PROTOCOL = IP_PROTOCOL(),
             IPV4_SRC_ADDRESS = IPV4_SRC_ADDRESS(),
             IPV4_DST_ADDRESS = IPV4_DST_ADDRESS(),
             IPV4_SRC_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(IPV4_SRC_ADDRESS()),
             IPV4_DST_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(IPV4_DST_ADDRESS()),
             IPV6_SRC_ADDRESS = IPV6_SRC_ADDRESS(),
             IPV6_DST_ADDRESS = IPV6_DST_ADDRESS(),
             IPV6_SRC_ADDRESS_AS_STRING = convertIPV6AddressNumericToString(IPV6_SRC_ADDRESS()),
             IPV6_DST_ADDRESS_AS_STRING = convertIPV6AddressNumericToString(IPV6_DST_ADDRESS()),
             IP_SRC_PORT = IP_SRC_PORT(),
             IP_DST_PORT = IP_DST_PORT(),
             UDP_PORT_53 = UDP_PORT(53uh),
             UDP_SRC_PORT = UDP_SRC_PORT(),
             UDP_DST_PORT = UDP_DST_PORT(),
             TCP_PORT_80 = TCP_PORT(80uh),
             TCP_SRC_PORT = TCP_SRC_PORT(),
             TCP_DST_PORT = TCP_DST_PORT(),
             TCP_SEQUENCE = TCP_SEQUENCE(),
             TCP_ACKNOWLEDGEMENT = TCP_ACKNOWLEDGEMENT(),
             TCP_FLAGS_URGENT = TCP_FLAGS_URGENT(),
             TCP_FLAGS_ACK = TCP_FLAGS_ACK(),
             TCP_FLAGS_PUSH = TCP_FLAGS_PUSH(),
             TCP_FLAGS_RESET = TCP_FLAGS_RESET(),
             TCP_FLAGS_SYN = TCP_FLAGS_SYN(),
             TCP_FLAGS_FIN = TCP_FLAGS_FIN(),
             TCP_WINDOW = TCP_WINDOW(),
             JMIRROR_SRC_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(JMIRROR_SRC_ADDRESS()),
             JMIRROR_DST_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(JMIRROR_DST_ADDRESS()),
             JMIRROR_SRC_PORT = JMIRROR_SRC_PORT(),
             JMIRROR_DST_PORT = JMIRROR_DST_PORT(),
             JMIRROR_INTERCEPT_ID = JMIRROR_INTERCEPT_ID(),
             JMIRROR_SESSION_ID = JMIRROR_SESSION_ID(),
             ERSPAN_SRC_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(ERSPAN_SRC_ADDRESS()),
             ERSPAN_DST_ADDRESS_AS_STRING = convertIPV4AddressNumericToString(ERSPAN_DST_ADDRESS()),
             PACKET_LENGTH = PACKET_LENGTH(),
             PAYLOAD_LENGTH = PAYLOAD_LENGTH(),
             PACKET_DATA = PACKET_DATA(),
             PAYLOAD_DATA = PAYLOAD_DATA();
     }
     () as PacketSink = FileSink(PacketStream) { param file: "debug.LivePacketLiveSourceFull.PacketStream.out"; format: txt; hasDelayField: true; flush: 1u; }
 
     () as Timeout = Custom() { logic onProcess: { block($timeoutInterval); shutdownPE(); } }
 
 }

   </pre>

</div>

</div>


</body>
</html>